<template>
    <lightning-card title="Order Details">
        <div class="slds-p-around_small">
            <lightning-radio-group name="radioGroup" data-label='radioGroup' label="Select an option for Order Creation"
                options={options} value={value} type="radio" onchange={handleChange}></lightning-radio-group>
        </div>
        <div class="slds-p-left_small slds-text-color_error slds-hidden" id="form-error-01">Select Existing Order or
            Create New.</div>
        <template if:true={isNew}>
            <div class="slds-p-around_small">
                <strong>Create New Order</strong>
                <lightning-layout multiple-rows>
                    <lightning-layout-item size="12" class="slds-p-top_xx-small slds-p-bottom_xx-small">
                        <c-gen-custom-lookup data-target-id="0" object-api-name="Account"
                            field-api-name="Business_Account__c" onselected={handleSelected} value={accountId}
                            field-label="Select an Account" label="accountId">
                        </c-gen-custom-lookup>
                    </lightning-layout-item>
                    <lightning-layout-item size="12" class="slds-p-bottom_xx-small">
                        <lightning-combobox name="AccountLocation" data-label='location' label="Account Location"
                            value={locationId} placeholder="Select Location" options={locations}
                            onchange={handleChange}>
                        </lightning-combobox>
                    </lightning-layout-item>
                    <lightning-layout-item size="12" class="slds-p-bottom_xx-small">
                        <lightning-combobox name="RelatedContacts" data-label='contact' label="Select Contact Person"
                            placeholder="Select Contact.." value={contactId} options={relatedContacts}
                            onchange={handleChange}>
                        </lightning-combobox>
                        <!--c-gen-custom-lookup object-api-name="Contact" field-api-name="ReportsToId"
                            onselected={handleSelected} value={contact} field-label="Select Contact Person" label="contact">
                        </c-gen-custom-lookup-->
                    </lightning-layout-item>
                </lightning-layout>
            </div>
        </template>

        <template if:true={isExisting}>
            <div if:true={isLoading} class="slds-is-relative">
                <lightning-spinner variant="brand" alternative-text="Loading" size="large"> </lightning-spinner>
            </div>
            <div class="slds-p-around_small">
                <p class="slds-p-bottom_small"><strong>Link an existing Order</strong></p>
                <lightning-input type="search" onchange={handleKeyChange} class="slds-p-top_x-small slds-m-bottom_small"
                    label="Search Orders (on Account name, status)" value={queryTerm}></lightning-input>
                <template for:each={data} for:item="rec" for:index="index">
                    <div key={rec.Id} class="slds-border_bottom slds-p-top_x-small slds-p-bottom_x-small">
                        <ul class="slds-has-block-links">
                            <li class="slds-item slds-list_horizontal">
                                <lightning-input data-target-id={index} variant="label-hidden" key={rec.Id}
                                    data-value={rec.Id} data-id={rec.AccountId} type="radio" name="radio"
                                    checked={rec.checked} value={rec.Id} onchange={handleRadioChange}>
                                </lightning-input>
                                <label class="slds-radio__label" for={rec.Id}>
                                    <strong><a data-ref={rec.Id}>{rec.OrderNumber}</a></strong>
                                </label>
                            </li>
                            <li class="slds-item">
                                <span class="slds-p-left_large">Account Name: {rec.AccountName}</span>
                            </li>
                            <li class="slds-item">
                                <span class="slds-p-left_large">Order Amount: {rec.TotalAmount}</span>
                            </li>
                            <li class="slds-item">
                                <span class="slds-p-left_large">Status: {rec.Status}</span>
                            </li>
                            <li class="slds-item">
                                <span class="slds-p-left_large">Order Start Date: {rec.EffectiveDate}</span>
                            </li>
                        </ul>
                    </div>
                </template>
                <template if:true={loadMoreButton}>
                    <lightning-button class="slds-align_absolute-center slds-p-top_small" variant="Neutral"
                        label="Load More" title="Load More" onclick={loadMore}>
                    </lightning-button>
                </template>
            </div>
        </template>
        <div slot="footer">
            <div class="slds-clearfix">
                <span class="slds-float_right">
                    <lightning-button variant="Netural" label="Back" title="Back" onclick={handleGoBack}>
                    </lightning-button>
                    <lightning-button class="slds-m-left_small" disabled={getNextButton} variant="brand" label="Next"
                        title="Next" onclick={handleGoNext}>
                    </lightning-button>
                </span>
            </div>
        </div>
    </lightning-card>
</template>